{% include "header.html" %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <style>
        .apexcharts-legend {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            overflow: auto;
            padding: 0 10px;
        }

        .apexcharts-legend-series {
            cursor: pointer;
            line-height: normal;
            display: flex;
            align-items: center;
            margin: 2px 5px;
        }

        .apexcharts-legend-text {
            position: relative;
            font-size: 12px;
            font-weight: 400;
            font-family: Helvetica, Arial, sans-serif;
            color: rgb(55, 61, 63);
        }

        .apexcharts-legend-marker {
            position: relative;
            display: inline-block;
            cursor: pointer;
            margin-right: 3px;
            border-style: solid;
            height: 12px;
            width: 12px;
            left: 0px;
            top: 0px;
            border-width: 0px;
            border-color: rgb(255, 255, 255);
            border-radius: 12px;
        }
    </style>



    <title>Aaj Tak Profile</title>
  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>

<body class="text-white">

    <div class="mx-4">
    <div class="flex items-center p-5 shadow-lg rounded-md border border-[#787A91] border-opacity-50 bg-gray-900 text-[#EEEEEE]">
        <a href="{% url 'story' channel_name=channel.name %}">
            <img class="w-20 h-20 rounded-full mr-5 object-cover border-4 " src="{{ channel.logo.url }}" alt="{{ channel.name }} Profile Image">
        </a>
        <div class="flex-1 w-full">
            <h2 class="text-lg font-bold mb-1 text-white">{{ channel.name }}</h2>
            <p class="text-sm text-white mb-2">{{ channel.tagline }}</p>
            <div class="flex text-sm text-white gap-4 lg:flex-row ">
                <a href="/">
                <div class="flex items-center lg:mr-0">
                    <i class="fab fa-youtube text-lg mr-1"></i>
                    <p class="text-sm text-white font-weight-bold">{{ channel.subscribers|default:"0" }}</p>
                </div>
            </a>
            <a href="/">
                <div class="flex items-center lg:mr-0">
                    <i class="fab fa-twitter text-lg mr-1"></i>
                    <p class="text-sm text-white font-weight-bold">{{ channel.twitter_followers|default:"0" }}</p>
                </div>
            </a>
            <a href="/">
                <div class="flex items-center lg:mr-0">
                    <i class="fab fa-facebook text-lg mr-1"></i>
                    <p class="text-sm text-white font-weight-bold">N/A</p> <!-- Facebook followers field is not provided -->
                </div>
            </a>
            </div>
        </div>
    </div>
    
    <div class="bg-gray-900 p-5 rounded-md  border border-[#787A91] border-opacity-50 shadow-lg mt-3 text-[#EEEEEE]">
        <h3 class=" text-sm mb-3 text-white">Political Spectrum</h3>
        <div class="relative w-full max-w-md mx-auto">
            <div class="absolute left-0 right-0 h-0.5 bg-white opacity-80"></div>
            <div id="chartPoint" class="absolute top-1/2 -mt-5 -ml-3 w-3 h-3 bg-red-500 rounded-full border-2 border-white"></div>
            <div class="flex justify-between mt-3 text-sm text-white">
                <span>Left</span>
                <span>Center</span>
                <span>Right</span>
            </div>
        </div>
    </div>
    
    
    <div class="flex justify-between items-center p-4 bg-gray-900 rounded-md   border border-[#787A91] border-opacity-50 shadow-lg mt-3 text-[#EEEEEE]">
        <div class="flex items-center space-x-2 text-white">
            <div>
                <i class="fab fa-youtube text-lg"></i>
            </div>
            <div>
                <p class="text-sm ">Ranking</p>
                <p class="text-xs font-bold">{{ channel.youtube_rank|default:"0" }}</p>
            </div>
        </div>
        <div class="flex items-center space-x-2 text-white">
            <div>
                <i class="far fa-newspaper text-lg"></i>
            </div>
            <div>
                <p class="text-sm">Fake News</p>
                <p class="text-sm font-bold text-bold">Low</p> <!-- Please replace this with actual data -->
            </div>
        </div>
        <div class="flex items-center space-x-2 text-white">
            <div>
                <i class="fas fa-check-circle text-lg"></i>
            </div>
            <div>
                <p class="text-sm ">Credibility</p>
                <p class="text-sm font-bold">High</p> <!-- Please replace this with actual data -->
            </div>
        </div>
    </div>
    <!-- ... -->
    
    <!-- ... -->
    
    <div class="bg-gray-900 p-5 rounded-md border border-[#787A91] border-opacity-50 shadow-lg mt-3 text-[#EEEEEE]">
        <h3 class="text-lg font-bold mb-3">About {{ channel.name }}</h3>
        <div class="overflow-x-auto">
            <table class="w-full text-xs md:text-sm text-gray-400 divide-y divide-gray-600">
                <!-- ... -->
                <tr>
                    <th class="px-3 py-2 bg-gray-700 font-semibold text-left">Official Website</th>
                    <td class="px-3 py-2 bg-gray-800"><a href="{{ channel.official_website }}" class="text-blue-500 hover:underline" target="_blank">{{ channel.official_website }}</a></td>
                </tr>
                <tr>
                    <th class="px-3 py-2 bg-gray-700 font-semibold text-left">YouTube</th>
                    <td class="px-3 py-2 bg-gray-800"><a href="{{ channel.youtube_channel }}" class="text-blue-500 hover:underline" target="_blank">{{ channel.youtube_channel }}</a></td>
                </tr>
                <tr>
                    <th class="px-3 py-2 bg-gray-700 font-semibold text-left">Twitter</th>
                    <td class="px-3 py-2 bg-gray-800"><a href="{{ channel.twitter_handle }}" class="text-blue-500 hover:underline" target="_blank">{{ channel.twitter_handle }}</a></td>
                </tr>
                <tr>
                    <th class="px-3 py-2 bg-gray-700 font-semibold text-left">Facebook</th>
                    <td class="px-3 py-2 bg-gray-800"><a href="{{ channel.facebook_page }}" class="text-blue-500 hover:underline" target="_blank">{{ channel.facebook_page }}</a></td>
                </tr>
                <!-- ... -->
            </table>
        </div>
    </div>
</div>

<div class="mt-3 p-5 rounded shadow-lg custom-chart lg:grid lg:grid-cols-2 ">
    <div class="" >
        <h2 class="text-[#FF4560]  font-bold mb-4 px-4 py-2 flex flex-row justify-center ">Most Popular Topics<button id="pieChartTopic" class="text-white shadow-lg rounded-full focus:outline-none">
            <i class="fas fa-info-circle fa-xs text-[#ff4560] p-1"></i>
        </button></h2>
        <canvas id="topicPieChart" class="text-white" style="position: relative; height:60vh; width:80vw "></canvas>
    </div>
    
    <script>
        const ctx = document.getElementById('topicPieChart').getContext('2d');
    
        const data = {
            labels: [
                {% for topic in topic_counts %}
                    '{{ topic.topic }}'{% if not forloop.last %},{% endif %}
                {% endfor %}
                {% if fifth_topic %}
                    , '{{ fifth_topic.topic }}'
                {% endif %}
            ],
            datasets: [{
                data: [
                    {% for topic in topic_counts %}
                        {{ topic.topic_count }}{% if not forloop.last %},{% endif %}
                    {% endfor %}
                    {% if fifth_topic %}
                        , {{ fifth_topic.topic_count }}
                    {% endif %}
                ],
                backgroundColor: [
                    '#FF4560',
                    '#008FFB',
                    '#00E396',
                    '#FFB01A',
                    '#775DD0'
                ],
                borderColor: [
                    '#ffffff',
                    '#ffffff',
                    '#FFFFFF',
                    '#ffffff',
                    '#ffffff'
                ],
                borderWidth: 3,
            }]
        };
    
        const config = {
            type: 'pie',
            data: data,
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            usePointStyle: true,
                            pointStyle: 'circle',
                            boxWidth: 20,
                            boxHeight: 20,
                            color: 'rgba(255, 255, 255, 0.7)',
                        }
                    },
                    title: {
                        display: true,
                        text: 'Top 5 Topics in the Last 48 Hours',
                        color: 'white'
                    }
                },
            },
        };
        
    
        new Chart(ctx, config);
    </script>
    

    <div class="my-3">
        <h2 class="text-[#FF4560]  font-bold mb-4 px-4 py-2 flex flex-row justify-center ">Modi vs Rahuul<button id="ragavsmodi" class="text-white shadow-lg rounded-full focus:outline-none">
            <i class="fas fa-info-circle fa-xs text-[#ff4560] p-1"></i>
        </button></h2>
        <div id="modiVSrahul"></div>

        <script>
            const historicalData = JSON.parse('{{ historical_counts | escapejs | safe }}');
            const datesModiRahul = Object.keys(historicalData);
            const modiCounts = datesModiRahul.map(date => historicalData[date]['Modi']);
            const rahulCounts = datesModiRahul.map(date => historicalData[date]['Rahul Gandhi']);
        
            var options = {
                series: [{
                    name: "Modi",
                    data: modiCounts
                },
                {
                    name: "Rahul Gandhi",
                    data: rahulCounts
                }],
                chart: {
                    type: 'area',
                    height: 350,
                    toolbar: {
                        show: false
                    },
                },
                    annotations: {
                        points: [{
                            x: datesModiRahul[modiCounts.length - 1],
                            y: modiCounts[modiCounts.length - 1],
                            image: {
                                path: "{% static 'images/modiface.png' %}",
                                width: 30,
                                height: 30
                            }
                        }, {
                            x: datesModiRahul[rahulCounts.length - 1],
                            y: rahulCounts[rahulCounts.length - 1],
                            image: {
                                path: "{% static 'images/rahulface.png' %}",
                                width: 30,
                                height: 30
                            }
                        }]
                    },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    curve: 'smooth'
                },
                xaxis: {
                    categories: datesModiRahul,
                    labels: {
                        style: {
                            colors: 'white'
                        },
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM',
                            day: 'dd',
                            hour: 'HH:mm',
                        }
                    }
                },
                yaxis: {
                    labels: {
                        style: {
                            colors: 'white'
                        },
                        formatter: function (value) {  // Add this formatter function
                            return value + "%";
                        }
                    }
                },
                tooltip: {
                    x: {
                        format: 'd MMM'
                    },
                    theme: 'dark',
                    style: {
                        background: 'gray',
                        color: 'white'
                    }
                },
                colors: ['#FF2949', '#007FE0'],
                legend: {
                    labels: {
                        colors: '#ffffff'
                    }
                }
            };
        
            var chart = new ApexCharts(document.querySelector("#modiVSrahul"), options);
            chart.render();
        </script>
        
    </div>

    <div class="my-3">
        <h2 class="text-[#FF4560]  font-bold mb-4 px-4 py-2 flex flex-row justify-center ">Religious Terms Used<button id="religious" class="text-white shadow-lg rounded-full focus:outline-none">
            <i class="fas fa-info-circle fa-xs text-[#ff4560] p-1"></i>
        </button></h2>
        <div id="religious-terms-chart"></div>
        <script>
            var historicalCounts = JSON.parse('{{ historical_counts|escapejs }}');
        
            var datesReligious = Object.keys(historicalCounts);
            var religiousData = datesReligious.map(date => historicalCounts[date]['Religious'] || 0);
        
            var options = {
            chart: {
                type: 'area',
                height: 350,
                foreColor: '#fff',
                toolbar: {
                    show: false
                },
            },
            series: [{
                name: 'Religious Terms',
                data: religiousData
            }],
            xaxis: {
                categories: datesReligious,
            },
            plotOptions: {
                bar: {
                    borderRadius: 15,
                borderRadiusApplication: 'end',   
                horizontal: false,
                columnWidth: '55%',
                endingShape: 'rounded',
                distributed: true
                },
            },
            colors: ['#00D18B'],
            dataLabels: {
                enabled: false
            },
          
           
            fill: {
                opacity: 1
            },
            legend: {
                show: false
            },
            tooltip: {
                theme: 'dark', // Sets tooltip theme to dark
                y: {
                formatter: function (val) {
                    return val + " %"
                }
                }
            }
            }
        
            var chart = new ApexCharts(document.querySelector("#religious-terms-chart"), options);
            chart.render();
        </script>
    </div>

    <div class="my-3">
        <h2 class="text-[#FF4560]  font-bold mb-4 px-4 py-2 flex flex-row justify-center ">Youtube Upload Frequency<button id="uploadfrequency" class="text-white shadow-lg rounded-full focus:outline-none">
            <i class="fas fa-info-circle fa-xs text-[#ff4560] p-1"></i>
        </button></h2> 
      <div id="frequencyChart"></div>
      
        <script>
            const uploadFrequencyData = JSON.parse('{{ upload_frequency|escapejs }}');
        
            const dates = [];
            const frequencies = [];
        
            const today = new Date();
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const day = date.getDate();
                const month = date.toLocaleString('default', { month: 'short' });
                const formattedDate = `${day} ${month}`;
                dates.push(formattedDate);
                frequencies.push(uploadFrequencyData[i]);
            }
        
            const frequencyChartOptions = {
                chart: {
                    type: 'bar',
                    height: 350,
                    toolbar: {
                        show: false
                    },
                    foreColor: '#ffffff',
                    animations: {
                        enabled: false
                    },
                    background: 'none'
                },
                plotOptions: {
                    bar: {
                        columnWidth: '50%', // Adjust this to change bar width
                        dataLabels: {
                            position: 'top', // top, center, bottom
                          },
                          borderRadius: 15,
                          borderRadiusApplication: 'end',
                    }
                },
                colors: ['#5224EB'],
                dataLabels: {
                    offsetY: -20,
                },
                series: [
                    {
                        name: 'Upload Frequency',
                        data: frequencies
                    }
                ],
                xaxis: {
                    categories: dates,
                    labels: {
                        format: 'dd MMM',
                        style: {
                            colors: '#ffffff'
                        }
                    },
                    axisBorder: {
                        show: false
                    },
                    axisTicks: {
                        show: false
                    }
                },
                yaxis: {
                    labels: {
                        style: {
                            colors: '#ffffff'
                        }
                    },
                    
                },
                theme: {
                    mode: 'dark',
                    
                }
            };
        
            const frequencyChart = new ApexCharts(document.querySelector('#frequencyChart'), frequencyChartOptions);
            frequencyChart.render();
        </script>
    </div>
      
      



</div>      

<div class=" mx-4 bg-gray-900 rounded-xl  overflow-hidden  border border-[#787A91] border-opacity-50 shadow-lg  text-[#EEEEEE]">
    <div class="p-4 md:p-4">
        <h2 class="text-base md:text-lg leading-6 font-medium text-gray-300 mb-2 md:mb-4">Latest Videos</h2>
        <ul class="space-y-2 md:space-y-4">
            {% for video in videos %}
            <li class="flex items-center">
                <div class="flex-shrink-0">
                    <div class="h-18 w-24">
                        <img class="object-contain rounded-lg " src="{{ video.thumbnail_url }}" alt="Video Thumbnail">
                    </div>
                </div>
                <div class="ml-4">
                    <h3 class="text-xs md:text-sm leading-5 font-medium text-white hover:text-[#FF2949] cursor-pointer">
                        <a href="{{ video.video_url }}" target="_blank" rel="noopener noreferrer">{{ video.title }}</a>
                    </h3>
                    <p class="text-xs text-gray-400">{{ video.channel.name }}</p>
                    <p class="text-xs text-gray-400">{{ video.published_date }}</p>
                </div>
            </li>
            {% empty %}
            <p class="text-gray-400">No videos available.</p>
            {% endfor %}
        </ul>
        <!-- Pagination Navigation -->
        <div class="mt-4">
            {% if videos.has_previous %}
                <a href="?page={{ videos.previous_page_number }}" class="text-xs text-gray-400 hover:text-white mr-4">Previous</a>
            {% endif %}
            <span class="text-xs text-gray-300">{{ videos.number }} of {{ videos.paginator.num_pages }}</span>
            {% if videos.has_next %}
                <a href="?page={{ videos.next_page_number }}" class="text-xs text-gray-400 hover:text-white ml-4">Next</a>
            {% endif %}
        </div>
    </div>
</div>








</div>



<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const ideologyScore = {{ channel.politcial_spectrum|default:"5" }};
        const chartPoint = document.getElementById("chartPoint");

        // Normalize the ideology score to a value between 0 and 100
        const normalizedScore = (ideologyScore - 1) * 100 / 9;

        // Set the position of the chart point based on the normalized score
        chartPoint.style.left = `${normalizedScore}%`;
    });
</script>


<script>
    // Function to generate an array of labels for the last 10 days
    function getLast10Days() {
        const today = new Date();
        const days = [];
        for (let i = 9; i >= 0; i--) {
            const day = new Date(today);
            day.setDate(today.getDate() - i);
            const formattedDay = day.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            days.push(formattedDay);
        }
        return days;
    }
</script>

<script>

    function createModalWithText(triggerElementId, text) {
        var modalId = triggerElementId + 'Modal';
  
        // Create the modal
        var modalHTML = `
        <div id="${modalId}" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center  backdrop-filter backdrop-blur-lg dark:border-slate-50/[0.06] bg-white/100 supports-backdrop-blur:bg-white/60 dark:bg-transparent ">
            <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50 "></div>
  
            <div class="modal-container w-11/12 md:max-w-md mx-auto rounded-lg shadow-lg z-50 overflow-y-auto backdrop-filter backdrop-blur-lg bg-white/100 supports-backdrop-blur:bg-white/60 dark:bg-transparent text-white border-slate-400 border-2">
                <div class="modal-close absolute top-0 right-0 cursor-pointer flex flex-col items-center mt-4 mr-4 text-white text-sm z-50">
                    <svg class="fill-current text-white" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">
                        <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path>
                    </svg>
                    
                </div>
  
                <div class="modal-content py-4 text-left px-6 ">
                    <div class="flex justify-between items-center pb-3">
                        <!-- Close button moved here -->
                    </div>
                    <p>${text}</p>
                </div>
            </div>
        </div>
    `;
  
  
        // Append the modal to the body
        document.body.insertAdjacentHTML('beforeend', modalHTML);
  
        var triggerElement = document.getElementById(triggerElementId);
        var modalElement = document.getElementById(modalId);
        var modalOverlayElement = modalElement.querySelector('.modal-overlay');
  
        // Attach click event to the trigger element
        triggerElement.addEventListener('click', function() {
            toggleModal(modalElement);
        });
  
        // Attach click event to the modal close elements
        var closeElements = modalElement.getElementsByClassName('modal-close');
        for (var i = 0; i < closeElements.length; i++) {
            closeElements[i].addEventListener('click', function() {
                toggleModal(modalElement);
            });
        }
  
        modalOverlayElement.addEventListener('click', function() {
            toggleModal(modalElement);
        });
  
  
    }
  
    function toggleModal(modal) {
        modal.classList.toggle('opacity-0')
        modal.classList.toggle('pointer-events-none')
        document.body.classList.toggle('modal-active')
    }
  
    document.onkeydown = function(evt) {
        evt = evt || window.event;
        var isEscape = false;
        if ("key" in evt) {
            isEscape = (evt.key === "Escape" || evt.key === "Esc");
        } else {
            isEscape = (evt.keyCode === 27);
        }
        if (isEscape && document.body.classList.contains('modal-active')) {
            var modals = document.getElementsByClassName('modal');
            for (var i = 0; i < modals.length; i++) {
                if (!modals[i].classList.contains('opacity-0')) {
                    toggleModal(modals[i]);
                    break;
                }
            }
        }
    };
    
      

    createModalWithText('pieChartTopic', 'This pie chart displays the most popular topics identified by our algorithm. The algorithm scraped video titles from various YouTube channels and categorized them accordingly. The data presented in the chart represents the popularity of these topics within a 48-hour timeframe.');
    createModalWithText('ragavsmodi', 'This line chart represents the percentage of video titles that contain the names(and similar terms) of Narendra Modi or Rahul Gandhi within the total videos of a channel over a 24-hour period. The chart spans a duration of one week, showcasing the fluctuations in the percentage and faceoff popularity trend within channels content');
    createModalWithText('religious', 'This chart illustrates the percentage of news articles that discuss religious topics, encompassing all religions. The criteria for identifying a news article as a religious topic can be found on our GitHub page, where you can access the full list of terms and qualifiers used for this classification. The chart provides insights into the prevalence of religious discussions within the news articles analyzed.');
    createModalWithText('uploadfrequency', 'Youtube pload frequency of given news channels over the past 7 days');

</script>


<!-- script for upload frequency -->
{% comment %} <script>
    // Upload Frequency
    const aajTakData = {
        labels: getLast10Days(),
        datasets: [{
            label: 'Video Upload Frequency',
            data: [12, 19, 3, 5, 2, 3, 8, 10, 15, 20], // Update this array with the actual data points for the news frequency
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1
        }]
    };

    const aajTakConfig = {
        type: 'bar',
        data: aajTakData,
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    };

    const aajTakChartElement = document.getElementById('aajTakChart');

    const aajTakChart = new Chart(aajTakChartElement, aajTakConfig);

    function getLastSixMonths() {
  const now = new Date();
  const months = [];
  for (let i = now.getMonth(); i >= now.getMonth() - 6; i--) {
    months.push(i);
  }
  return months;
}
</script>

<script>
    //fakenewsdata
    const fakeNewsData = {
        labels: getLastSixMonths(),
        datasets: [{
            label: 'Fake News Instances',
            data: [5, 3, 10, 8, 4, 6], // Update this array with the actual data points for the fake news instances
            backgroundColor: 'rgba(255, 99, 132, 0.2)',
            borderColor: 'rgba(255, 99, 132, 1)',
            borderWidth: 2,
            tension: 0.4
        }]
    };


    const fakeNewsConfig = {
        type: 'bubble',
        
        data: fakeNewsData, 
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    position: 'left'
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            },
            plugins: {
                legend: {
                    display: true
                }
            },
            elements: {
                bar: {
                    borderRadius: 5
                }
            },
            layout: {
                padding: 20
            }
        }
    };

    const fakeNewsChartElement = document.getElementById('fakeNewsChart');

    const fakeNewsChart = new Chart(fakeNewsChartElement, fakeNewsConfig);

</script> {% endcomment %}





</body>

{% include 'footer.html' %}
</html>